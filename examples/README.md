# Examples

This directory contains a number of different examples showing useful ways to
use pggen. They contain checked in versions of the generated code and an
`output.txt` file showing what they print so that you don't have to go to
the trouble of running them if you don't want to. Because it is checked in
when the example is first written, the generated code may not be entirely
up to date with the most recent master version of pggen.

## Instructions For Running

First, `cd` into the example directory, then set up the database

```bash
> createdb pggen_development
> psql pggen_development < db.sql
```

Make sure that `$DB_URL` is `postgres://localhost/pggen_development?sslmode=disable` either
by explicitly setting it in the environment with

```bash
export DB_URL=postgres://localhost/pggen_development?sslmode=disable
```

or by installing `direnv` and doing `direnv allow` at the repo root (this will `source` the
`.envrc` file).

Finally, run the program

```bash
> go run ./main.go
```

## List of Examples

### [Example: extending_models](extending_models)

This example shows how to add methods containing business logic to the model
structs generated by `pggen`. This can help you avoid an error prone and labor
intensive manual translation from the model structs to an extra layer just so
you can define methods on the intermediate layer.

### [Example: id_in_set](id_in_set)

This example shows how to write a query that checks for set containment
using the `= ANY` idiom rather than the `IN` operator that is typically
used with other database interactivity libraries.

### [Example: include_specs](include_specs)

This example shows how to use include specs to tell pggen how to fill in
records which are associated with one another via foreign keys. Include specs
are the key to the way that pggen deals with associations.


### [Example: timestamps and soft deletion](timestamps)

This example shows how to make use of the automatic timestamp features that
pggen provides. You can ask pggen to automatically take care of keeping track
created at and updated at timestamps. Soft deletes are often implemented with
a timestamp rather than just a boolean flag, so pggen supports them using
similar machinery, which is also demonstrated in this example.
